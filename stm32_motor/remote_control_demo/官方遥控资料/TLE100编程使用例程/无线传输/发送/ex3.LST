C51 COMPILER V9.59.0.0   EX3                                                               07/18/2022 18:39:03 PAGE 1   


C51 COMPILER V9.59.0.0, COMPILATION OF MODULE EX3
OBJECT MODULE PLACED IN ex3.OBJ
COMPILER INVOKED BY: C:\Keil_v5\C51\BIN\C51.EXE ex3.c OPTIMIZE(8,SPEED) BROWSE DEBUG OBJECTEXTEND TABS(2)

line level    source

   1          #include<reg51.h>  //包含51单片机寄存器定义的头文件
   2          #include "intrins.h"
   3          #define uint unsigned int 
   4          #define uchar unsigned char 
   5          
   6          #define true  1 
   7          #define false 0 
   8            
   9          sbit  WX_M0=P1^2;
  10          sbit  WX_M1=P1^1;
  11          uchar RX_DATA=0;
  12          
  13          void delay_nus(unsigned int i);
  14          //串口初始化
  15          void init_9600(void)
  16          {
  17   1          TMOD = 0x20;      
  18   1          TH1 = 0xFD;   
  19   1          TL1 = 0xFD;
  20   1          SCON = 0x50;      
  21   1          PCON &= 0xef;   
  22   1          IE |= 0x90 ;             //Enable Serial Interrupt  
  23   1          TR1 = 1;
  24   1      }
  25          //发送一个字节
  26          void send_char(unsigned char txd)
  27          {
  28   1          SBUF = txd;
  29   1          while(!TI);     
  30   1          TI = 0;         
  31   1      }
  32          void send_one_byte_to_char(unsigned char ch)
  33          {
  34   1        if ((ch & 0xf0) > 0x90)
  35   1        {
  36   2          send_char(((ch>>4)&0x0f) + 'A'-0x0a);
  37   2        }
  38   1        else
  39   1        {
  40   2          send_char(((ch>>4)&0x0f) + '0'-0x00);
  41   2        }
  42   1        if ((ch & 0x0f) > 0x09)
  43   1        {
  44   2          send_char((ch&0x0f) + 'A'-0x0a);
  45   2        }
  46   1        else
  47   1        {
  48   2          send_char((ch&0x0f) + '0'-0x00);
  49   2        }
  50   1      }
  51          void send_two_byte_to_char(unsigned int ch)
  52          {
  53   1        //3
  54   1        if ((ch & 0xf000) > 0x9000)
  55   1        {
C51 COMPILER V9.59.0.0   EX3                                                               07/18/2022 18:39:03 PAGE 2   

  56   2          send_char(((ch>>12)&0x000f) + 'A'-0x0a);
  57   2        }
  58   1        else
  59   1        {
  60   2          send_char(((ch>>12)&0x000f) + '0'-0x00);
  61   2        }
  62   1        //2
  63   1        if ((ch & 0x0f00) > 0x0900)
  64   1        {
  65   2          send_char(((ch>>8)&0x000f) + 'A'-0x0a);
  66   2        }
  67   1        else
  68   1        {
  69   2          send_char(((ch>>8)&0x000f) + '0'-0x00);
  70   2        }
  71   1        //1
  72   1        if ((ch & 0x00f0) > 0x0090)
  73   1        {
  74   2          send_char(((ch>>4)&0x000f) + 'A'-0x0a);
  75   2        }
  76   1        else
  77   1        {
  78   2          send_char(((ch>>4)&0x000f) + '0'-0x00);
  79   2        }
  80   1        //0
  81   1        if ((ch & 0x000f) > 0x0009)
  82   1        {
  83   2          send_char((ch&0x000f) + 'A'-0x0a);
  84   2        }
  85   1        else
  86   1        {
  87   2          send_char((ch&0x000f) + '0'-0x00);
  88   2        }
  89   1      }
  90          void send_four_byte_to_char(uchar a,uchar b,uchar c,uchar d)
  91          {
  92   1          send_char(a+'0'-0x00);
  93   1          send_char(b+'0'-0x00);
  94   1          send_char(c+'0'-0x00);
  95   1          send_char(d+'0'-0x00);
  96   1      }
  97          //发送字符串
  98          void send_string(char *p)
  99          {
 100   1        char *pchar;
 101   1      
 102   1        pchar = p;
 103   1        while (*pchar != '\0')
 104   1        {
 105   2          send_char(*pchar++);    
 106   2        }
 107   1      }
 108          
 109          //延时100us
 110           void delay_100us(unsigned int n)  //n=11
 111          { 
 112   1       while(--n);   
 113   1      }   
 114          //延时 m 个100us
 115          void delay_nus(unsigned int m)  //m*100us
 116          { 
 117   1        
C51 COMPILER V9.59.0.0   EX3                                                               07/18/2022 18:39:03 PAGE 3   

 118   1        while(--m)
 119   1        {
 120   2          delay_100us(11);  
 121   2        }   
 122   1              
 123   1      }   
 124          //延时函数1毫秒
 125          void delay1ms()
 126          {
 127   1         unsigned char i,j; 
 128   1         for(i=0;i<3;i++)
 129   1          for(j=0;j<29;j++)
 130   1           ;     
 131   1       }
 132          
 133          //延时函数，n毫秒
 134           void delaynms(unsigned int n)
 135           {
 136   1         unsigned int i;
 137   1        for(i=0;i<n;i++)
 138   1           delay1ms();
 139   1       }
 140          
 141          //主函数
 142          void main(void)
 143          {
 144   1          uint a,b,c,x,y;
 145   1          uchar d;
 146   1          EA = 0;
 147   1          init_9600();
 148   1          EA = 1;
 149   1        
 150   1          WX_M0=0;//传输模式
 151   1          WX_M1=0;
 152   1        
 153   1          while(1)
 154   1          {   
 155   2              send_char(0x99);
 156   2              //send_char(0x02);  
 157   2              //send_char(0x03);
 158   2              //send_char(0x04);
 159   2              //send_char(0x05);
 160   2              //send_char(0x06);
 161   2              //send_char(0x07);
 162   2              //send_char(0x08);
 163   2              //send_char(0x09);
 164   2            
 165   2              delaynms(1000);
 166   2                
 167   2          }       
 168   1      }
*** WARNING C280 IN LINE 144 OF ex3.c: 'a': unreferenced local variable
*** WARNING C280 IN LINE 144 OF ex3.c: 'b': unreferenced local variable
*** WARNING C280 IN LINE 144 OF ex3.c: 'c': unreferenced local variable
*** WARNING C280 IN LINE 144 OF ex3.c: 'x': unreferenced local variable
*** WARNING C280 IN LINE 144 OF ex3.c: 'y': unreferenced local variable
*** WARNING C280 IN LINE 145 OF ex3.c: 'd': unreferenced local variable
 169          
 170          //串口接收中断函数
 171          void serial () interrupt 4 using 3
 172          {
 173   1          if (RI) //开始接收
C51 COMPILER V9.59.0.0   EX3                                                               07/18/2022 18:39:03 PAGE 4   

 174   1          {
 175   2              RI = 0 ; //软件RI=0
 176   2              RX_DATA=SBUF;
 177   2              
 178   2          }
 179   1          
 180   1      } 


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    394    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =      1      18
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  6 WARNING(S),  0 ERROR(S)
